"use strict";(self.webpackChunkwebpack_react_ts_preset_1=self.webpackChunkwebpack_react_ts_preset_1||[]).push([[150],{3913:(e,t,r)=>{r.d(t,{A:()=>c});var n=r(4848);const a={link:"WWbseSOQ",shadow:"qPf1KUkR",primary:"EhyyJqDL",filled:"yQYZSKm2",secondary:"AoChoFaF",outlined:"XGcduZrw",none:"xge20BlT"};var o=r(4976),s=r(211),i=function(){return i=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},i.apply(this,arguments)};const c=function(e){var t=e.variant,r=void 0===t?"filled":t,c=e.color,u=void 0===c?"primary":c,l=e.shadow,d=void 0===l||l,f=e.icon,p=void 0===f?null:f,h=e.className,m=void 0===h?"":h,v=(e.setTopScroll,e.children),g=e.to,y=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]])}return r}(e,["variant","color","shadow","icon","className","setTopScroll","children","to"]);return s.e&&(0,s.e)(),(0,n.jsxs)(o.N_,i({to:g,className:[a.link,a[u],a[r],d&&a.shadow,m].join(" ")},y,{children:[p,v]}))}},8413:(e,t,r)=>{r.d(t,{Y:()=>a});var n=["января","февраля","марта","апреля","мая","июня","июля","августа","сентября","октября","ноября","декабря"],a=function(e,t){var r=new Date(e),a=r.getDate(),o=r.getMonth(),s=r.getFullYear(),i=o<10?"0".concat(o+1):o+1,c=a<10?"0".concat(a):a;switch(t){case"text":return"".concat(a," ").concat(n[o],", ").concat(s);case"date":return"".concat(c,".").concat(i,".").concat(s)}}},211:(e,t,r)=>{r.d(t,{e:()=>n});var n=function(e){void 0===e&&(e="instant"),window.scrollTo({top:0,behavior:e})}},29:(e,t,r)=>{r.d(t,{B:()=>a});var n=r(6540),a=function(e,t){var r=new IntersectionObserver((function(e){e.forEach((function(e){e.isIntersecting&&(console.log("go!!!"),t())}))}),{threshold:.7});(0,n.useEffect)((function(){return e.current&&r.observe(e.current),function(){r.disconnect()}}),[e,t])}},6149:(e,t,r)=>{r.d(t,{p:()=>i});var n=r(148),a=r(4303),o=n.Q.User,s=n.Q.Profile,i=function(e){return(0,a.G)((function(e){return e.auth.userId}))===e?"/".concat(s):"/".concat(o,"/").concat(e)}},6150:(e,t,r)=>{r.r(t),r.d(t,{default:()=>M});var n=r(4848),a=r(7767);var o=r(9358),s=r(7494),i=r(3393),c=r(148),u=r(3913);const l={wrap:"EMVrqCVL",content:"YqiS0h_C",header:"Djthjtny",published:"HFxHdVgG",desc:"O3VxlsDR"};var d=r(2374);const f={comment:"ezkptb56"};var p=r(9785),h=function(){return h=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},h.apply(this,arguments)};const m=function(e){var t=e.userId,r=e.forummessageId,a=(0,o.vb)(),s=a[0],i=(a[1],(0,p.mN)()),c=i.register,u=i.handleSubmit,l=i.formState,m=(l.errors,l.isSubmitting),v=i.getValues;return t?(0,n.jsxs)("form",{onSubmit:u((function(e){return n=void 0,a=void 0,i=function(){var e;return function(e,t){var r,n,a,o,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function i(i){return function(c){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;o&&(o=0,i[0]&&(s=0)),s;)try{if(r=1,n&&(a=2&i[0]?n.return:i[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,i[1])).done)return a;switch(n=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,n=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!((a=(a=s.trys).length>0&&a[a.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){s.label=i[1];break}if(6===i[0]&&s.label<a[1]){s.label=a[1],a=i;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(i);break}a[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],n=0}finally{r=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,c])}}}(this,(function(n){switch(n.label){case 0:return e=v("text"),[4,s({userId:t,forummessageId:r,text:e})];case 1:return n.sent(),[2]}}))},new((o=void 0)||(o=Promise))((function(e,t){function r(e){try{c(i.next(e))}catch(e){t(e)}}function s(e){try{c(i.throw(e))}catch(e){t(e)}}function c(t){var n;t.done?e(t.value):(n=t.value,n instanceof o?n:new o((function(e){e(n)}))).then(r,s)}c((i=i.apply(n,a||[])).next())}));var n,a,o,i})),children:[(0,n.jsx)("textarea",h({className:f.comment},c("text",{minLength:35}),{placeholder:"Комментарий"})),(0,n.jsx)(d.A,{disabled:m,type:"submit",children:"Отправить"})]}):(0,n.jsx)("div",{className:f.notAuth,children:"Авторизируйтесь, чтобы ответить на сообщение!"})};var v=r(8413),g=r(6149),y=r(4303);const b=function(e){var t=e.id,r=e.title,a=e.login,o=e.description,s=e.datetime,i=e.userId,c=(0,v.Y)(s,"text"),d=(0,g.p)(i),f=(0,y.G)((function(e){return e.auth.userId}));return(0,n.jsx)("div",{className:l.wrap,children:(0,n.jsxs)("div",{className:l.content,children:[(0,n.jsxs)("header",{className:l.header,children:[(0,n.jsx)("h1",{className:l.title,children:r}),(0,n.jsx)(u.A,{to:d,variant:"none",shadow:!1,children:a})]}),(0,n.jsxs)("time",{dateTime:s,className:l.published,children:["Опубликовано ",c]}),(0,n.jsx)("p",{className:l.desc,children:o}),(0,n.jsx)(m,{userId:f,forummessageId:t})]})})},j={header:"HELITAHh",published:"dtFra4AZ",text:"R13kRw9H"};var x=r(6540);const w=(0,x.memo)((function(e){e.id;var t=e.userId,r=e.login,a=e.datetime,o=e.text,s=(0,v.Y)(a,"date"),i=(0,g.p)(t);return(0,n.jsxs)("div",{className:j.comment,children:[(0,n.jsxs)("header",{className:j.header,children:[(0,n.jsx)(u.A,{shadow:!1,variant:"none",to:i,children:r}),(0,n.jsx)("time",{dateTime:a,className:j.published,children:s})]}),(0,n.jsx)("p",{className:j.text,children:o})]})}));var O=r(5831),F=r(29),A=function(){return A=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},A.apply(this,arguments)},N=function(){return N=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},N.apply(this,arguments)};const C=function(e){var t,r,a=(t=e.forumMessageId,r=(0,y.G)((function(e){return e.commentFilter})),(0,o.VP)(A(A({},r),{id:t}))),i=a.data,c=a.isLoading,u=a.isFetching,l=a.isError,d=(0,y.j)(),f=null==i?void 0:i.data,p=null==i?void 0:i.totalCount,h=(0,y.G)((function(e){return e.commentFilter.limit}))||10,m=(0,y.G)((function(e){return e.commentFilter.page})),v=(0,x.useRef)(null),g=Math.ceil(p/h)<=m;return(0,F.B)(v,(function(){g||d((0,O.Ir)())})),console.log(f),(c||u)&&1===m?(0,n.jsx)(s.A,{}):l?(0,n.jsx)("p",{children:"Ошибка"}):(0,n.jsx)("div",{className:"PCBmWlIy",children:(null==f?void 0:f.length)?(0,n.jsxs)("div",{className:"JLkoiz8r",children:[f.map((function(e){return(0,n.jsx)(w,N({id:e._id},e),e._id)})),(c||u)&&1!==m?(0,n.jsx)("div",{className:"nyMtRhaP",children:(0,n.jsx)(s.A,{})}):(0,n.jsx)("div",{ref:v,className:"Wf0vbjw6"})]}):(0,n.jsx)("p",{children:"Это сообщение пока не получило ответа. Будьте первым!"})})};var I=function(){return I=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},I.apply(this,arguments)};c.Q.User;const M=function(){var e=(0,a.g)().id,t=(0,o.UF)(e),r=t.data,c=t.isLoading,u=t.isFetching,l=t.isError;return c||u?(0,n.jsx)(s.A,{}):l?(0,n.jsx)("p",{children:"Ошибка"}):r&&(0,n.jsx)(i.A,{children:(0,n.jsxs)("div",{className:"UurNjtbT",children:[(0,n.jsx)(b,I({id:r._id},r)),(0,n.jsx)(C,{forumMessageId:r._id})]})})}},9358:(e,t,r)=>{r.d(t,{UF:()=>f,VP:()=>p,cL:()=>d,vb:()=>h});var n=r(8324),a=r(2963),o=r(8023),s=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]])}return r},i=n.BH.FORUM,c=n.BH.COMMENTS,u=n.BH.CREATE,l=o.s.injectEndpoints({endpoints:function(e){return{fetchAllForumMessages:e.query({query:function(e){var t=e.page,r=e.limit,n=e.textQuery;return{url:"".concat(i),params:{sortByDate:!0,search:n,page:t,limit:r,userLogin:!0}}},transformResponse:function(e,t){var r,n,a=null===(n=null===(r=null==t?void 0:t.response)||void 0===r?void 0:r.headers)||void 0===n?void 0:n.get("X-Total-Count");return{data:e,totalCount:a?+a:1}},serializeQueryArgs:function(e){e.endpointName;var t=e.queryArgs;return t.page,s(t,["page"]),{queryArgs:t}},forceRefetch:function(e){var t=e.currentArg,r=e.previousArg;if(!t||!r)return!0;t.page;var n=s(t,["page"]),o=(r.page,s(r,["page"]));return(0,a.A)(n,o)}}),fetchForumMessageById:e.query({query:function(e){return{url:"".concat(i,"/").concat(e),params:{userLogin:!0}}}}),fetchForumCommentsByMessage:e.query({providesTags:["ForumComment"],query:function(e){var t=e.id,r=e.page,n=e.limit;return{url:"".concat(i,"/").concat(t).concat(c),params:{sortByDate:!0,limit:n,page:r,userLogin:!0}}},transformResponse:function(e,t){var r,n,a=null===(n=null===(r=null==t?void 0:t.response)||void 0===r?void 0:r.headers)||void 0===n?void 0:n.get("X-Total-Count");return{data:e,totalCount:a?+a:1}},serializeQueryArgs:function(e){var t=e.endpointName,r=e.queryArgs,n=(r.page,s(r,["page"]));return JSON.stringify(n)+t},merge:function(e,t,r){var n,a=r.arg,o=r.requestId;1===a.page?e.data=t.data:o&&(n=e.data).push.apply(n,t.data)},forceRefetch:function(e){var t=e.currentArg,r=e.previousArg;if(!t||!r)return!0;var n=t.page,o=s(t,["page"]),i=r.page,c=s(r,["page"]);return(0,a.A)(o,c)&&n!==i}}),createForumMessage:e.mutation({query:function(e){return{url:"".concat(i).concat(u),method:"POST",body:e}}}),createForumComment:e.mutation({invalidatesTags:["ForumComment"],query:function(e){return{url:"".concat(i).concat(c).concat(u),method:"POST",body:e}}})}}}),d=l.useFetchAllForumMessagesQuery,f=l.useFetchForumMessageByIdQuery,p=l.useFetchForumCommentsByMessageQuery,h=l.useCreateForumCommentMutation;l.useCreateForumMessageMutation,l.useLazyFetchAllForumMessagesQuery,l.useLazyFetchForumCommentsByMessageQuery}}]);
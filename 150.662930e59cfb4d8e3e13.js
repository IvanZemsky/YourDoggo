"use strict";(self.webpackChunkyourdoggo=self.webpackChunkyourdoggo||[]).push([[150],{29:(e,t,r)=>{r.d(t,{B:()=>a});var n=r(6540),a=function(e,t){var r=new IntersectionObserver((function(e){e.forEach((function(e){e.isIntersecting&&(console.log("go!!!"),t())}))}),{threshold:.7});(0,n.useEffect)((function(){return e.current&&r.observe(e.current),function(){r.disconnect()}}),[e,t])}},6149:(e,t,r)=>{r.d(t,{p:()=>i});var n=r(148),a=r(4303),o=n.Q.User,s=n.Q.Profile,i=function(e){return(0,a.G)((function(e){return e.auth.userId}))===e?"/".concat(s):"/".concat(o,"/").concat(e)}},6150:(e,t,r)=>{r.r(t),r.d(t,{default:()=>M});var n=r(4848),a=r(7767);var o=r(9358),s=r(7494),i=r(3393),c=r(148),u=r(3913);const l={wrap:"EMVrqCVL",content:"YqiS0h_C",header:"Djthjtny",published:"HFxHdVgG",desc:"O3VxlsDR"};var d=r(780);const f={comment:"ezkptb56"};var h=r(9785),m=function(){return m=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},m.apply(this,arguments)};const p=function(e){var t=e.userId,r=e.forummessageId,a=(0,o.vb)(),s=a[0],i=(a[1],(0,h.mN)()),c=i.register,u=i.handleSubmit,l=i.formState,p=(l.errors,l.isSubmitting),g=i.getValues;return t?(0,n.jsxs)("form",{onSubmit:u((function(e){return n=void 0,a=void 0,i=function(){var e;return function(e,t){var r,n,a,o,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function i(i){return function(c){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;o&&(o=0,i[0]&&(s=0)),s;)try{if(r=1,n&&(a=2&i[0]?n.return:i[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,i[1])).done)return a;switch(n=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,n=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!((a=(a=s.trys).length>0&&a[a.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){s.label=i[1];break}if(6===i[0]&&s.label<a[1]){s.label=a[1],a=i;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(i);break}a[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],n=0}finally{r=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,c])}}}(this,(function(n){switch(n.label){case 0:return e=g("text"),[4,s({userId:t,forummessageId:r,text:e})];case 1:return n.sent(),[2]}}))},new((o=void 0)||(o=Promise))((function(e,t){function r(e){try{c(i.next(e))}catch(e){t(e)}}function s(e){try{c(i.throw(e))}catch(e){t(e)}}function c(t){var n;t.done?e(t.value):(n=t.value,n instanceof o?n:new o((function(e){e(n)}))).then(r,s)}c((i=i.apply(n,a||[])).next())}));var n,a,o,i})),children:[(0,n.jsx)("textarea",m({className:f.comment},c("text",{minLength:35}),{placeholder:"Комментарий"})),(0,n.jsx)(d.A,{disabled:p,type:"submit",children:"Отправить"})]}):(0,n.jsx)("div",{className:f.notAuth,children:"Авторизируйтесь, чтобы ответить на сообщение!"})};var g=r(3049),v=r(6149),y=r(4303);const j=function(e){var t=e.id,r=e.title,a=e.login,o=e.description,s=e.datetime,i=e.userId,c=(0,g.Y)(s,"text"),d=(0,v.p)(i),f=(0,y.G)((function(e){return e.auth.userId}));return(0,n.jsx)("div",{className:l.wrap,children:(0,n.jsxs)("div",{className:l.content,children:[(0,n.jsxs)("header",{className:l.header,children:[(0,n.jsx)("h1",{className:l.title,children:r}),(0,n.jsx)(u.A,{to:d,variant:"none",shadow:!1,children:a})]}),(0,n.jsxs)("time",{dateTime:s,className:l.published,children:["Опубликовано ",c]}),(0,n.jsx)("p",{className:l.desc,children:o}),(0,n.jsx)(p,{userId:f,forummessageId:t})]})})},b={header:"HELITAHh",published:"dtFra4AZ",text:"R13kRw9H"};var x=r(6540);const F=(0,x.memo)((function(e){e.id;var t=e.userId,r=e.login,a=e.datetime,o=e.text,s=(0,g.Y)(a,"date"),i=(0,v.p)(t);return(0,n.jsxs)("div",{className:b.comment,children:[(0,n.jsxs)("header",{className:b.header,children:[(0,n.jsx)(u.A,{shadow:!1,variant:"none",to:i,children:r}),(0,n.jsx)("time",{dateTime:a,className:b.published,children:s})]}),(0,n.jsx)("p",{className:b.text,children:o})]})}));var O=r(5831),w=r(29),A=function(){return A=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},A.apply(this,arguments)},N=function(){return N=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},N.apply(this,arguments)};const C=function(e){var t=function(e){var t=(0,y.G)((function(e){return e.commentFilter})),r=(0,y.j)();return(0,x.useEffect)((function(){e!==t.forumMessageID&&(r((0,O.zC)()),r((0,O.aJ)(e)))}),[]),(0,o.VP)(A(A({},t),{id:e}))}(e.forumMessageId),r=t.data,a=t.isLoading,i=t.isFetching,c=t.isError,u=(0,y.j)(),l=null==r?void 0:r.data,d=null==r?void 0:r.totalCount,f=(0,y.G)((function(e){return e.commentFilter.limit}))||10,h=(0,y.G)((function(e){return e.commentFilter.page})),m=(0,x.useRef)(null),p=Math.ceil(d/f)<=h;return(0,w.B)(m,(function(){p||u((0,O.Ir)())})),console.log(l),(a||i)&&1===h?(0,n.jsx)(s.A,{}):c?(0,n.jsx)("p",{children:"Ошибка"}):(0,n.jsx)("div",{className:"PCBmWlIy",children:(null==l?void 0:l.length)?(0,n.jsxs)("div",{className:"JLkoiz8r",children:[l.map((function(e){return(0,n.jsx)(F,N({id:e._id},e),e._id)})),(a||i)&&1!==h?(0,n.jsx)("div",{className:"nyMtRhaP",children:(0,n.jsx)(s.A,{})}):(0,n.jsx)("div",{ref:m,className:"Wf0vbjw6"})]}):(0,n.jsx)("p",{children:"Это сообщение пока не получило ответа. Будьте первым!"})})};var I=function(){return I=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},I.apply(this,arguments)};c.Q.User;const M=function(){var e=(0,a.g)().id,t=(0,o.UF)(e),r=t.data,c=t.isLoading,u=t.isFetching,l=t.isError;return c||u?(0,n.jsx)(s.A,{}):l?(0,n.jsx)("p",{children:"Ошибка"}):r&&(0,n.jsx)(i.A,{children:(0,n.jsxs)("div",{className:"UurNjtbT",children:[(0,n.jsx)(j,I({id:r._id},r)),(0,n.jsx)(C,{forumMessageId:r._id})]})})}},9358:(e,t,r)=>{r.d(t,{UF:()=>f,VP:()=>h,cL:()=>d,vb:()=>m});var n=r(8324),a=r(6327),o=r(8023),s=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]])}return r},i=n.BH.FORUM,c=n.BH.COMMENTS,u=n.BH.CREATE,l=o.s.injectEndpoints({endpoints:function(e){return{fetchAllForumMessages:e.query({query:function(e){var t=e.page,r=e.limit,n=e.textQuery;return{url:"".concat(i),params:{sortByDate:!0,search:n,page:t,limit:r,userLogin:!0}}},transformResponse:function(e,t){var r,n,a=null===(n=null===(r=null==t?void 0:t.response)||void 0===r?void 0:r.headers)||void 0===n?void 0:n.get("X-Total-Count");return{data:e,totalCount:a?+a:1}},serializeQueryArgs:function(e){e.endpointName;var t=e.queryArgs;return t.page,s(t,["page"]),{queryArgs:t}},forceRefetch:function(e){var t=e.currentArg,r=e.previousArg;if(!t||!r)return!0;t.page;var n=s(t,["page"]),o=(r.page,s(r,["page"]));return(0,a.A)(n,o)}}),fetchForumMessageById:e.query({query:function(e){return{url:"".concat(i,"/").concat(e),params:{userLogin:!0}}}}),fetchForumCommentsByMessage:e.query({providesTags:["ForumComment"],query:function(e){var t=e.id,r=e.page,n=e.limit;return{url:"".concat(i,"/").concat(t).concat(c),params:{sortByDate:!0,limit:n,page:r,userLogin:!0}}},transformResponse:function(e,t){var r,n,a=null===(n=null===(r=null==t?void 0:t.response)||void 0===r?void 0:r.headers)||void 0===n?void 0:n.get("X-Total-Count");return{data:e,totalCount:a?+a:1}},serializeQueryArgs:function(e){var t=e.endpointName,r=e.queryArgs,n=(r.page,s(r,["page"]));return JSON.stringify(n)+t},merge:function(e,t,r){var n,a=r.arg,o=r.requestId;1===a.page?e.data=t.data:o&&(n=e.data).push.apply(n,t.data)},forceRefetch:function(e){var t=e.currentArg,r=e.previousArg;if(!t||!r)return!0;var n=t.page,o=s(t,["page"]),i=r.page,c=s(r,["page"]);return(0,a.A)(o,c)&&n!==i}}),createForumMessage:e.mutation({query:function(e){return{url:"".concat(i).concat(u),method:"POST",body:e}}}),createForumComment:e.mutation({invalidatesTags:["ForumComment"],query:function(e){return{url:"".concat(i).concat(c).concat(u),method:"POST",body:e}}})}}}),d=l.useFetchAllForumMessagesQuery,f=l.useFetchForumMessageByIdQuery,h=l.useFetchForumCommentsByMessageQuery,m=l.useCreateForumCommentMutation;l.useCreateForumMessageMutation,l.useLazyFetchAllForumMessagesQuery,l.useLazyFetchForumCommentsByMessageQuery},6327:(e,t,r)=>{function n(e,t){var r=Object.entries(e),n=Object.entries(t);if(r.length!==n.length)return!1;for(var a=0;a<r.length;++a)if(r[a][0]!==n[a][0]||r[a][1]!==n[a][1])return!1;return!0}r.d(t,{A:()=>n})},3049:(e,t,r)=>{r.d(t,{Y:()=>a});var n=["января","февраля","марта","апреля","мая","июня","июля","августа","сентября","октября","ноября","декабря"],a=function(e,t){var r=new Date(e),a=r.getDate(),o=r.getMonth(),s=r.getFullYear(),i=o<10?"0".concat(o+1):o+1,c=a<10?"0".concat(a):a;switch(t){case"text":return"".concat(a," ").concat(n[o],", ").concat(s);case"date":return"".concat(c,".").concat(i,".").concat(s)}}}}]);
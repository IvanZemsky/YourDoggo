"use strict";(self.webpackChunkyourdoggo=self.webpackChunkyourdoggo||[]).push([[150],{29:(e,t,r)=>{r.d(t,{B:()=>o});var n=r(6540),a={threshold:.7},o=function(e,t,r){void 0===r&&(r=a);var o=new IntersectionObserver((function(e){e.forEach((function(e){e.isIntersecting&&t()}))}),r);(0,n.useEffect)((function(){return e.current&&o.observe(e.current),function(){o.disconnect()}}),[e,t])}},6149:(e,t,r)=>{r.d(t,{p:()=>i});var n=r(148),a=r(4303),o=n.Q.User,s=n.Q.Profile,i=function(e){return(0,a.G)((function(e){return e.auth.userId}))===e?"/".concat(s):"/".concat(o,"/").concat(e)}},6150:(e,t,r)=>{r.r(t),r.d(t,{default:()=>M});var n=r(4848),a=r(7767);var o=r(9358),s=r(7494),i=r(9913),u=r(148);const c={wrap:"EMVrqCVL",content:"YqiS0h_C",header:"Djthjtny",published:"HFxHdVgG",desc:"O3VxlsDR"},l={comment:"ezkptb56"};var d=r(9785),f=function(){return f=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},f.apply(this,arguments)};const h=function(e){var t=e.userId,r=e.forummessageId,a=(0,o.vb)({fixedCacheKey:"newComment"}),s=a[0],u=(a[1],(0,d.mN)()),c=u.register,h=u.handleSubmit,m=u.formState,p=(m.errors,m.isSubmitting),g=u.getValues,v=u.reset;return t?(0,n.jsxs)("form",{onSubmit:h((function(e){return n=void 0,a=void 0,i=function(){var e;return function(e,t){var r,n,a,o,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function i(i){return function(u){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;o&&(o=0,i[0]&&(s=0)),s;)try{if(r=1,n&&(a=2&i[0]?n.return:i[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,i[1])).done)return a;switch(n=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,n=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!((a=(a=s.trys).length>0&&a[a.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){s.label=i[1];break}if(6===i[0]&&s.label<a[1]){s.label=a[1],a=i;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(i);break}a[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],n=0}finally{r=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}}(this,(function(n){switch(n.label){case 0:return e=g("text"),[4,s({userId:t,forummessageId:r,text:e})];case 1:return n.sent(),v(),[2]}}))},new((o=void 0)||(o=Promise))((function(e,t){function r(e){try{u(i.next(e))}catch(e){t(e)}}function s(e){try{u(i.throw(e))}catch(e){t(e)}}function u(t){var n;t.done?e(t.value):(n=t.value,n instanceof o?n:new o((function(e){e(n)}))).then(r,s)}u((i=i.apply(n,a||[])).next())}));var n,a,o,i})),children:[(0,n.jsx)("textarea",f({className:l.comment},c("text",{required:"Описание должно быть не менее 35 символов",minLength:{value:25,message:"Описание должно быть не менее 35 символов"}}),{placeholder:"Комментарий"})),(0,n.jsx)(i.$n,{disabled:p,type:"submit",children:"Отправить"})]}):(0,n.jsx)("div",{className:l.notAuth,children:"Авторизируйтесь, чтобы ответить на сообщение!"})};var m=r(3049),p=r(6149),g=r(4303);const v=function(e){var t=e.id,r=e.title,a=e.login,o=e.description,s=e.datetime,u=e.userId,l=(0,m.Y)(s,"text"),d=(0,p.p)(u),f=(0,g.G)((function(e){return e.auth.userId}));return(0,n.jsx)("div",{className:c.wrap,children:(0,n.jsxs)("div",{className:c.content,children:[(0,n.jsxs)("header",{className:c.header,children:[(0,n.jsx)("h1",{className:c.title,children:r}),(0,n.jsx)(i.Ek,{to:d,variant:"none",shadow:!1,children:a})]}),(0,n.jsxs)("time",{dateTime:s,className:c.published,children:["Опубликовано ",l]}),(0,n.jsx)("p",{className:c.desc,children:o}),(0,n.jsx)(h,{userId:f,forummessageId:t})]})})},y={header:"HELITAHh",published:"dtFra4AZ",text:"R13kRw9H"};var j=r(6540);const x=(0,j.memo)((function(e){e.id;var t=e.userId,r=e.login,a=e.datetime,o=e.text,s=(0,m.Y)(a,"date"),u=(0,p.p)(t);return(0,n.jsxs)("div",{className:y.comment,children:[(0,n.jsxs)("header",{className:y.header,children:[(0,n.jsx)(i.Ek,{shadow:!1,variant:"none",to:u,children:r}),(0,n.jsx)("time",{dateTime:a,className:y.published,children:s})]}),(0,n.jsx)("p",{className:y.text,children:o})]})}));var b=r(5831),w=r(29),O=function(){return O=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},O.apply(this,arguments)},F=function(){return F=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},F.apply(this,arguments)};const C=function(e){var t=e.forumMessageId,r=(0,g.j)(),a=function(e){var t=(0,g.G)((function(e){return e.commentFilter})),r=(0,g.j)();return(0,j.useEffect)((function(){e!==t.forumMessageID&&(r((0,b.zC)()),r((0,b.aJ)(e)))}),[]),(0,o.VP)(O(O({},t),{id:e}))}(t),i=a.data,u=a.isLoading,c=a.isFetching,l=a.isError,d=(0,o.vb)({fixedCacheKey:"newComment"}),f=(d[0],d[1].data),h=null==i?void 0:i.data,m=null==i?void 0:i.totalCount,p=(0,g.G)((function(e){return e.commentFilter.limit}))||10,v=(0,g.G)((function(e){return e.commentFilter.page})),y=(0,j.useRef)(null),C=m&&Math.ceil(m/p)<=v,N=(0,g.G)((function(e){return e.auth.userLogin}))||"",M=(0,j.useCallback)((function(){C||u||c||r((0,b.Ir)())}),[C,u,c,r]);return(0,w.B)(y,M),u&&1===v?(0,n.jsx)(s.A,{}):l?(0,n.jsx)("p",{children:"Ошибка"}):(0,n.jsx)("div",{className:"PCBmWlIy",children:(0,n.jsxs)("div",{className:"JLkoiz8r",children:[f&&(0,n.jsx)(x,F({id:f._id,login:N},f)),(null==h?void 0:h.length)?(0,n.jsxs)(j.Fragment,{children:[h.map((function(e){return(0,n.jsx)(x,F({id:e._id},e),e._id)})),c&&1!==v?(0,n.jsx)("div",{className:"nyMtRhaP",children:(0,n.jsx)(s.A,{})}):(0,n.jsx)("div",{ref:y,className:"Wf0vbjw6"})]}):(0,n.jsx)("p",{children:"Это сообщение пока не получило ответа. Будьте первым!"})]})})};var N=function(){return N=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},N.apply(this,arguments)};u.Q.User;const M=function(){var e=(0,a.g)().id,t=(0,o.UF)(e),r=t.data,u=t.isLoading,c=t.isFetching,l=t.isError;return u||c?(0,n.jsx)(s.A,{}):l?(0,n.jsx)("p",{children:"Ошибка"}):r&&(0,n.jsx)(i.mO,{children:(0,n.jsxs)("div",{className:"UurNjtbT",children:[(0,n.jsx)(v,N({id:r._id},r)),(0,n.jsx)(C,{forumMessageId:r._id})]})})}},9358:(e,t,r)=>{r.d(t,{Nn:()=>p,UF:()=>f,VP:()=>h,cL:()=>d,vb:()=>m});var n=r(8324),a=r(6327),o=r(8023),s=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]])}return r},i=n.BH.FORUM,u=n.BH.COMMENTS,c=n.BH.CREATE,l=o.s.injectEndpoints({endpoints:function(e){return{fetchAllForumMessages:e.query({query:function(e){var t=e.page,r=e.limit,n=e.textQuery;return{url:"".concat(i),params:{sortByDate:!0,search:n,page:t,limit:r,userLogin:!0}}},transformResponse:function(e,t){var r,n,a=null===(n=null===(r=null==t?void 0:t.response)||void 0===r?void 0:r.headers)||void 0===n?void 0:n.get("X-Total-Count");return{data:e,totalCount:a?+a:1}},serializeQueryArgs:function(e){e.endpointName;var t=e.queryArgs;return t.page,s(t,["page"]),{queryArgs:t}},forceRefetch:function(e){var t=e.currentArg,r=e.previousArg;if(!t||!r)return!0;t.page;var n=s(t,["page"]),o=(r.page,s(r,["page"]));return(0,a.A)(n,o)}}),fetchForumMessageById:e.query({query:function(e){return{url:"".concat(i,"/").concat(e),params:{userLogin:!0}}}}),fetchForumCommentsByMessage:e.query({query:function(e){var t=e.id,r=e.page,n=e.limit;return{url:"".concat(i,"/").concat(t).concat(u),params:{limit:n,page:r,userLogin:!0}}},transformResponse:function(e,t){var r,n,a=null===(n=null===(r=null==t?void 0:t.response)||void 0===r?void 0:r.headers)||void 0===n?void 0:n.get("X-Total-Count");return{data:e,totalCount:a?+a:1}},serializeQueryArgs:function(e){var t=e.endpointName,r=e.queryArgs,n=(r.page,s(r,["page"]));return JSON.stringify(n)+t},merge:function(e,t,r){var n,a=r.arg,o=r.requestId;1===a.page?e.data=t.data:o&&(n=e.data).push.apply(n,t.data)},forceRefetch:function(e){var t=e.currentArg,r=e.previousArg;if(!t||!r)return!0;var n=t.page,o=s(t,["page"]),i=r.page,u=s(r,["page"]);return(0,a.A)(o,u)&&n!==i}}),createForumMessage:e.mutation({invalidatesTags:["ForumMessage"],query:function(e){return{url:"".concat(i).concat(c),method:"POST",body:e}}}),createForumComment:e.mutation({query:function(e){return{url:"".concat(i).concat(u).concat(c),method:"POST",body:e}}})}}}),d=l.useFetchAllForumMessagesQuery,f=l.useFetchForumMessageByIdQuery,h=l.useFetchForumCommentsByMessageQuery,m=l.useCreateForumCommentMutation,p=l.useCreateForumMessageMutation;l.useLazyFetchAllForumMessagesQuery,l.useLazyFetchForumCommentsByMessageQuery},6327:(e,t,r)=>{function n(e,t){var r=Object.entries(e),n=Object.entries(t);if(r.length!==n.length)return!1;for(var a=0;a<r.length;++a)if(r[a][0]!==n[a][0]||r[a][1]!==n[a][1])return!1;return!0}r.d(t,{A:()=>n})},3049:(e,t,r)=>{r.d(t,{Y:()=>a});var n=["января","февраля","марта","апреля","мая","июня","июля","августа","сентября","октября","ноября","декабря"],a=function(e,t){var r=new Date(e),a=r.getDate(),o=r.getMonth(),s=r.getFullYear(),i=o<10?"0".concat(o+1):o+1,u=a<10?"0".concat(a):a;switch(t){case"text":return"".concat(a," ").concat(n[o],", ").concat(s);case"date":return"".concat(u,".").concat(i,".").concat(s)}}}}]);
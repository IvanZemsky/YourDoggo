"use strict";(self.webpackChunkyourdoggo=self.webpackChunkyourdoggo||[]).push([[836],{9726:(e,t,r)=>{r.d(t,{w:()=>o});var n=r(6540),a=r(7767),o=function(e,t,r){void 0===r&&(r=[]);var o=(0,a.Zp)();(0,n.useEffect)((function(){e||o(t)}),function(e,t,r){if(r||2===arguments.length)for(var n,a=0,o=t.length;a<o;a++)!n&&a in t||(n||(n=Array.prototype.slice.call(t,0,a)),n[a]=t[a]);return e.concat(n||Array.prototype.slice.call(t))}([e],r,!0))}},9836:(e,t,r)=>{r.r(t),r.d(t,{default:()=>k});var n=r(4848),a=r(9913);const o={wrapper:"Xlx2KH49",content:"k1gr_uRn",title:"bPTSm7Ww",textWrap:"HkUw5Xe7",tagsWrap:"YMMMwa9r",input:"KvmgTSPk",error:"dczX35Bp",publish:"SWcLovCt"};var i=r(3996),c=r(4303),l=r(148),s=r(9726),u=r(9785),f=r(7767);const d={info:"mX13icG0",textWrap:"nWRr5Uza",panel:"SLR7Kvjr",textContent:"QnhpC4NW"};var p=r(6540);const h=function(){return(0,n.jsx)("textarea",{className:"Q6ksk8pf",placeholder:"Блок текста"})},g=function(){return(0,n.jsx)("input",{type:"text",className:"gMVGWigI",placeholder:"Заголовок"})};var m=r(5288);const y=function(){var e=(0,m.t)(),t=e.imgLink,r=e.isError,a=e.debouncedHandler,o=e.handleImageLoad,i=e.handleImageError,c=(0,p.useRef)(null);return(0,n.jsxs)("div",{className:"AwlDxyMU",children:[(0,n.jsx)("input",{type:"text",placeholder:"Вставьте ссылку на изображение",onChange:a,ref:c}),t&&!r&&(0,n.jsx)("img",{src:t,alt:"Иллюстрация",onLoad:o,onError:i}),r&&(0,n.jsx)("p",{children:"Ошибка загрузки изображения. Проверьте ссылку."})]})};var v=function(e,t,r){if(r||2===arguments.length)for(var n,a=0,o=t.length;a<o;a++)!n&&a in t||(n||(n=Array.prototype.slice.call(t,0,a)),n[a]=t[a]);return e.concat(n||Array.prototype.slice.call(t))};const x=(0,p.forwardRef)((function(e,t){var r=(0,p.useState)([]),o=r[0],i=r[1];return(0,n.jsxs)("div",{className:d.content,children:[(0,n.jsx)("p",{className:d.info,children:"Добавьте текст, загаловки и изображения"}),(0,n.jsxs)("div",{className:d.textWrap,children:[(0,n.jsxs)("div",{className:d.panel,children:[(0,n.jsx)(a.$n,{title:"Текст",onClick:function(){i(v(v([],o,!0),[(0,n.jsx)(h,{},o.length)],!1))},children:"T"}),(0,n.jsx)(a.$n,{title:"Заголовок",onClick:function(){i(v(v([],o,!0),[(0,n.jsx)(g,{},o.length)],!1))},children:"H"}),(0,n.jsx)(a.$n,{title:"Изображение",onClick:function(){i(v(v([],o,!0),[(0,n.jsx)(y,{},o.length)],!1))},children:"IMG"})]}),(0,n.jsx)("div",{className:d.textContent,ref:t,children:o&&o.map((function(e){return e}))})]})]})}));var b=function(e){return e.replace(/[&<>"']/g,(function(e){return{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"}[e]||e}))};console.log(b("<div>hi</div>"));var j=function(){return j=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},j.apply(this,arguments)},A=l.Q.Signin,w=l.Q.Articles;const k=function(){var e=(0,f.Zp)(),t=(0,u.mN)(),r=t.register,l=t.control,d=t.handleSubmit,h=t.formState,g=h.errors,m=h.isSubmitting,y=t.getValues,v=(0,i.jd)()[0],k=(0,c.G)((function(e){return e.auth.userId})),N=(0,p.useRef)(null),I=[];return(0,s.w)(!!k,"/".concat(A)),(0,n.jsx)(a.mO,{additionalStyles:o.wrapper,children:(0,n.jsxs)("section",{className:o.content,children:[(0,n.jsx)("h1",{className:o.title,children:"Создание статьи"}),(0,n.jsxs)("form",{className:o.form,onSubmit:d((function(t){return r=void 0,n=void 0,o=function(){var t,r,n,a;return function(e,t){var r,n,a,o,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function c(c){return function(l){return function(c){if(r)throw new TypeError("Generator is already executing.");for(;o&&(o=0,c[0]&&(i=0)),i;)try{if(r=1,n&&(a=2&c[0]?n.return:c[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,c[1])).done)return a;switch(n=0,a&&(c=[2&c[0],a.value]),c[0]){case 0:case 1:a=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,n=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!((a=(a=i.trys).length>0&&a[a.length-1])||6!==c[0]&&2!==c[0])){i=0;continue}if(3===c[0]&&(!a||c[1]>a[0]&&c[1]<a[3])){i.label=c[1];break}if(6===c[0]&&i.label<a[1]){i.label=a[1],a=c;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(c);break}a[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],n=0}finally{r=a=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,l])}}}(this,(function(o){switch(o.label){case 0:return t=y("title"),r=y("imgLink"),n=function(e){var t="";if(e.current)for(var r=e.current.children,n=0;n<r.length;n++){var a=r[n];if("TEXTAREA"===a.tagName)t+="<p>".concat(b(a.value),"</p>");else if("INPUT"===a.tagName&&"text"===a.type)t+="<b>".concat(b(a.value),"</b>");else if("DIV"===a.tagName&&a.querySelector("img")){var o=a.querySelector("img");o&&(t+='<img src="'.concat(o.src,'" alt="').concat(b(o.alt),'"/>'))}}return console.log(t),t}(N),[4,v({userId:k,title:t,imgLink:r,tags:I,text:n})];case 1:return"data"in(a=o.sent())&&e("/".concat(w,"/").concat(a.data._id)),[2]}}))},new((a=void 0)||(a=Promise))((function(e,t){function i(e){try{l(o.next(e))}catch(e){t(e)}}function c(e){try{l(o.throw(e))}catch(e){t(e)}}function l(t){var r;t.done?e(t.value):(r=t.value,r instanceof a?r:new a((function(e){e(r)}))).then(i,c)}l((o=o.apply(r,n||[])).next())}));var r,n,a,o})),children:[(0,n.jsx)(a.pd,j({placeholder:"Название статьи",className:o.input},r("title",{required:"Заголовок должен быть не менее 10 не более 70 символов",minLength:{value:10,message:"Заголовок должен быть не менее 10 не более 70 символов"},maxLength:{value:70,message:"Заголовок должен быть не менее 10 не более 70 символов"}}))),(0,n.jsx)("p",{className:o.error,children:g.title&&"".concat(g.title.message)}),(0,n.jsx)(u.xI,{name:"imgLink",control:l,defaultValue:"",rules:{required:"Это поле не должно быть пустым",minLength:1},render:function(e){var t=e.field;return(0,n.jsx)(a.sP,j({imgText:"Обложка",placeholder:"Картинка превью (ссылка)",className:o.input,handleChange:t.onChange},t))}}),(0,n.jsx)("p",{className:o.error,children:g.imgLink&&"".concat(g.imgLink.message)}),(0,n.jsx)(x,{ref:N}),(0,n.jsx)("p",{className:o.error,children:g.text&&"".concat(g.text.message)}),(0,n.jsx)(a.gK,{setItemList:function(e){I=function(e,t,r){if(r||2===arguments.length)for(var n,a=0,o=t.length;a<o;a++)!n&&a in t||(n||(n=Array.prototype.slice.call(t,0,a)),n[a]=t[a]);return e.concat(n||Array.prototype.slice.call(t))}([],e,!0)}}),(0,n.jsx)(a.$n,{type:"submit",className:o.publish,disabled:m,children:"Опубликовать"})]})]})})}},3996:(e,t,r)=>{r.d(t,{E6:()=>f,IP:()=>u,jd:()=>d});var n=r(8324),a=r(8023),o=r(6327),i=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]])}return r},c=n.BH.ARTICLES,l=n.BH.CREATE,s=a.s.injectEndpoints({endpoints:function(e){return{fetchAllArticles:e.query({query:function(e){var t=e.limit,r=e.page,n=e.userLogin,a=e.userId,o=e.authUserId,i=e.textQuery,l=e.liked;return{url:"".concat(c,"/?sortByDate=true"),method:"POST",params:{limit:t,page:r,userLogin:n,search:i,liked:l||"",userId:a},body:{authUserId:o||""}}},transformResponse:function(e,t){var r,n,a=null===(n=null===(r=null==t?void 0:t.response)||void 0===r?void 0:r.headers)||void 0===n?void 0:n.get("X-Total-Count");return{data:e,totalCount:a?+a:1}},serializeQueryArgs:function(e){e.endpointName;var t=e.queryArgs;return t.page,i(t,["page"]),{queryArgs:t}},forceRefetch:function(e){var t=e.currentArg,r=e.previousArg;if(!t||!r)return!0;t.page;var n=i(t,["page"]),a=(r.page,i(r,["page"]));return(0,o.A)(n,a)}}),fetchArticleById:e.query({query:function(e){var t=e.id,r=e.userLogin,n=e.authUserId;return{url:"".concat(c,"/").concat(t),method:"POST",params:{userLogin:r},body:{authUserId:n||""}}}}),createArticle:e.mutation({query:function(e){return{url:"".concat(c).concat(l),method:"POST",body:e}}})}}}),u=s.useFetchAllArticlesQuery,f=s.useFetchArticleByIdQuery,d=s.useCreateArticleMutation;s.useLazyFetchAllArticlesQuery,s.useLazyFetchArticleByIdQuery},6327:(e,t,r)=>{function n(e,t){var r=Object.entries(e),n=Object.entries(t);if(r.length!==n.length)return!1;for(var a=0;a<r.length;++a)if(r[a][0]!==n[a][0]||r[a][1]!==n[a][1])return!1;return!0}r.d(t,{A:()=>n})}}]);
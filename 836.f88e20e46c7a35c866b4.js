"use strict";(self.webpackChunkyourdoggo=self.webpackChunkyourdoggo||[]).push([[836],{5767:(e,t,r)=>{r.d(t,{A:()=>i});var n=r(4848),a=r(6540),o=r(77),c=r(5288);const i=(0,a.forwardRef)((function(e,t){e.imgText;var r=e.handleChange,a=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]])}return r}(e,["imgText","handleChange"]),i=(0,c.t)(),l=i.imgLink,s=i.isError,u=i.debouncedHandler,f=i.handleImageLoad,p=i.handleImageError;return(0,n.jsxs)("div",{children:[(0,n.jsx)(o.A,{type:"text",placeholder:"Вставьте ссылку на изображение",onChange:function(e){u(e),r(e.target.value)},className:a.className}),l&&!s&&(0,n.jsx)("img",{src:l,alt:"Иллюстрация",onLoad:f,onError:p}),s&&(0,n.jsx)("p",{children:"Ошибка загрузки изображения. Проверьте ссылку."})]})}))},77:(e,t,r)=>{r.d(t,{A:()=>i});var n=r(4848),a=r(6540);const o={input:"qIxXL6mW"};var c=function(){return c=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},c.apply(this,arguments)};const i=(0,a.forwardRef)((function(e,t){var r=e.className,a=void 0===r?"":r,i=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]])}return r}(e,["className"]),l=[o.input,a].join(" ");return(0,n.jsx)("input",c({type:"text",className:l},i,{ref:t}))}))},1394:(e,t,r)=>{r.d(t,{A:()=>u});var n=r(4848),a=r(780);const o=function(e){var t=e.tag,r=e.handleRemove;return(0,n.jsx)(a.A,{className:"WDYhK9vV",onClick:r,children:t})};var c=r(9785),i=r(6540),l=function(){return l=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},l.apply(this,arguments)},s=function(e,t,r){if(r||2===arguments.length)for(var n,a=0,o=t.length;a<o;a++)!n&&a in t||(n||(n=Array.prototype.slice.call(t,0,a)),n[a]=t[a]);return e.concat(n||Array.prototype.slice.call(t))};const u=function(e){var t=e.setItemList,r=(0,c.mN)(),a=r.register,u=r.getValues,f=r.resetField,p=(0,i.useState)([]),d=p[0],h=p[1];return(0,i.useEffect)((function(){t(d)}),[d]),(0,n.jsxs)("div",{className:"IQu64fxn",children:[!!d.length&&(0,n.jsx)(n.Fragment,{children:d.map((function(e,t){return(0,n.jsx)(o,{tag:e,handleRemove:(r=e,function(){h(d.filter((function(e){return e!==r})))})},e+t);var r}))}),(0,n.jsx)("input",l({type:"text"},a("tag",{required:!1,minLength:3,maxLength:25}),{onBlur:function(){var e=u("tag");e.trim().length&&(h(s(s([],d,!0),[e],!1)),f("tag"))},placeholder:"Тег"}))]})}},5288:(e,t,r)=>{r.d(t,{t:()=>a});var n=r(6540),a=function(){var e,t,r,a=(0,n.useState)(""),o=a[0],c=a[1],i=(0,n.useState)(!1),l=i[0],s=i[1],u=function(e){c(e.target.value),s(!1)},f=(e=u,500,t=(0,n.useRef)(null),r=(0,n.useCallback)((function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];t.current&&clearTimeout(t.current),t.current=setTimeout((function(){e.apply(void 0,r)}),500)}),[e,500]),r);return{imgLink:o,isError:l,debouncedHandler:f,handleInputChange:u,handleImageLoad:function(){s(!1)},handleImageError:function(){s(!0)}}}},9726:(e,t,r)=>{r.d(t,{w:()=>o});var n=r(6540),a=r(7767),o=function(e,t,r){void 0===r&&(r=[]);var o=(0,a.Zp)();(0,n.useEffect)((function(){e||o(t)}),function(e,t,r){if(r||2===arguments.length)for(var n,a=0,o=t.length;a<o;a++)!n&&a in t||(n||(n=Array.prototype.slice.call(t,0,a)),n[a]=t[a]);return e.concat(n||Array.prototype.slice.call(t))}([e],r,!0))}},9836:(e,t,r)=>{r.r(t),r.d(t,{default:()=>k});var n=r(4848),a=r(3393);const o={wrapper:"Xlx2KH49",content:"k1gr_uRn",title:"bPTSm7Ww",textWrap:"HkUw5Xe7",tagsWrap:"YMMMwa9r",input:"KvmgTSPk",error:"dczX35Bp",publish:"SWcLovCt"};var c=r(77),i=r(780),l=r(3996),s=r(4303),u=r(148),f=r(9726),p=r(9785),d=r(7767),h=r(1394);const g={info:"mX13icG0",textWrap:"nWRr5Uza",panel:"SLR7Kvjr",textContent:"QnhpC4NW"};var m=r(6540);const v=function(){return(0,n.jsx)("textarea",{className:"Q6ksk8pf",placeholder:"Блок текста"})},y=function(){return(0,n.jsx)("input",{type:"text",className:"gMVGWigI",placeholder:"Заголовок"})};var x=r(5288);const j=function(){var e=(0,x.t)(),t=e.imgLink,r=e.isError,a=e.debouncedHandler,o=e.handleImageLoad,c=e.handleImageError,i=(0,m.useRef)(null);return(0,n.jsxs)("div",{className:"AwlDxyMU",children:[(0,n.jsx)("input",{type:"text",placeholder:"Вставьте ссылку на изображение",onChange:a,ref:i}),t&&!r&&(0,n.jsx)("img",{src:t,alt:"Иллюстрация",onLoad:o,onError:c}),r&&(0,n.jsx)("p",{children:"Ошибка загрузки изображения. Проверьте ссылку."})]})};var b=function(e,t,r){if(r||2===arguments.length)for(var n,a=0,o=t.length;a<o;a++)!n&&a in t||(n||(n=Array.prototype.slice.call(t,0,a)),n[a]=t[a]);return e.concat(n||Array.prototype.slice.call(t))};const A=(0,m.forwardRef)((function(e,t){var r=(0,m.useState)([]),a=r[0],o=r[1];return(0,n.jsxs)("div",{className:g.content,children:[(0,n.jsx)("p",{className:g.info,children:"Добавьте текст, загаловки и изображения"}),(0,n.jsxs)("div",{className:g.textWrap,children:[(0,n.jsxs)("div",{className:g.panel,children:[(0,n.jsx)(i.A,{title:"Текст",onClick:function(){o(b(b([],a,!0),[(0,n.jsx)(v,{},a.length)],!1))},children:"T"}),(0,n.jsx)(i.A,{title:"Заголовок",onClick:function(){o(b(b([],a,!0),[(0,n.jsx)(y,{},a.length)],!1))},children:"H"}),(0,n.jsx)(i.A,{title:"Изображение",onClick:function(){o(b(b([],a,!0),[(0,n.jsx)(j,{},a.length)],!1))},children:"IMG"})]}),(0,n.jsx)("div",{className:g.textContent,ref:t,children:a&&a.map((function(e){return e}))})]})]})}));var O=function(e){return e.replace(/[&<>"']/g,(function(e){return{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"}[e]||e}))};console.log(O("<div>hi</div>"));var w=r(5767),I=function(){return I=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},I.apply(this,arguments)},N=u.Q.Signin,L=u.Q.Articles;const k=function(){var e=(0,d.Zp)(),t=(0,p.mN)(),r=t.register,u=t.control,g=t.handleSubmit,v=t.formState,y=v.errors,x=v.isSubmitting,j=t.getValues,b=(0,l.jd)()[0],k=(0,s.G)((function(e){return e.auth.userId})),S=(0,m.useRef)(null),C=[];return(0,f.w)(!!k,"/".concat(N)),(0,n.jsx)(a.A,{additionalStyles:o.wrapper,children:(0,n.jsxs)("section",{className:o.content,children:[(0,n.jsx)("h1",{className:o.title,children:"Создание статьи"}),(0,n.jsxs)("form",{className:o.form,onSubmit:g((function(t){return r=void 0,n=void 0,o=function(){var t,r,n,a;return function(e,t){var r,n,a,o,c={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function i(i){return function(l){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;o&&(o=0,i[0]&&(c=0)),c;)try{if(r=1,n&&(a=2&i[0]?n.return:i[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,i[1])).done)return a;switch(n=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return c.label++,{value:i[1],done:!1};case 5:c.label++,n=i[1],i=[0];continue;case 7:i=c.ops.pop(),c.trys.pop();continue;default:if(!((a=(a=c.trys).length>0&&a[a.length-1])||6!==i[0]&&2!==i[0])){c=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){c.label=i[1];break}if(6===i[0]&&c.label<a[1]){c.label=a[1],a=i;break}if(a&&c.label<a[2]){c.label=a[2],c.ops.push(i);break}a[2]&&c.ops.pop(),c.trys.pop();continue}i=t.call(e,c)}catch(e){i=[6,e],n=0}finally{r=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,l])}}}(this,(function(o){switch(o.label){case 0:return t=j("title"),r=j("imgLink"),n=function(e){var t="";if(e.current)for(var r=e.current.children,n=0;n<r.length;n++){var a=r[n];if("TEXTAREA"===a.tagName)t+="<p>".concat(O(a.value),"</p>");else if("INPUT"===a.tagName&&"text"===a.type)t+="<b>".concat(O(a.value),"</b>");else if("DIV"===a.tagName&&a.querySelector("img")){var o=a.querySelector("img");o&&(t+='<img src="'.concat(o.src,'" alt="').concat(O(o.alt),'"/>'))}}return console.log(t),t}(S),[4,b({userId:k,title:t,imgLink:r,tags:C,text:n})];case 1:return"data"in(a=o.sent())&&e("/".concat(L,"/").concat(a.data._id)),[2]}}))},new((a=void 0)||(a=Promise))((function(e,t){function c(e){try{l(o.next(e))}catch(e){t(e)}}function i(e){try{l(o.throw(e))}catch(e){t(e)}}function l(t){var r;t.done?e(t.value):(r=t.value,r instanceof a?r:new a((function(e){e(r)}))).then(c,i)}l((o=o.apply(r,n||[])).next())}));var r,n,a,o})),children:[(0,n.jsx)(c.A,I({placeholder:"Название статьи",className:o.input},r("title",{required:"Заголовок должен быть не менее 10 не более 70 символов",minLength:{value:10,message:"Заголовок должен быть не менее 10 не более 70 символов"},maxLength:{value:70,message:"Заголовок должен быть не менее 10 не более 70 символов"}}))),(0,n.jsx)("p",{className:o.error,children:y.title&&"".concat(y.title.message)}),(0,n.jsx)(p.xI,{name:"imgLink",control:u,defaultValue:"",rules:{required:"Это поле не должно быть пустым",minLength:1},render:function(e){var t=e.field;return(0,n.jsx)(w.A,I({imgText:"Обложка",placeholder:"Картинка превью (ссылка)",className:o.input,handleChange:t.onChange},t))}}),(0,n.jsx)("p",{className:o.error,children:y.imgLink&&"".concat(y.imgLink.message)}),(0,n.jsx)(A,{ref:S}),(0,n.jsx)("p",{className:o.error,children:y.text&&"".concat(y.text.message)}),(0,n.jsx)(h.A,{setItemList:function(e){C=function(e,t,r){if(r||2===arguments.length)for(var n,a=0,o=t.length;a<o;a++)!n&&a in t||(n||(n=Array.prototype.slice.call(t,0,a)),n[a]=t[a]);return e.concat(n||Array.prototype.slice.call(t))}([],e,!0)}}),(0,n.jsx)(i.A,{type:"submit",className:o.publish,disabled:x,children:"Опубликовать"})]})]})})}},3996:(e,t,r)=>{r.d(t,{E6:()=>f,IP:()=>u,jd:()=>p});var n=r(8324),a=r(8023),o=r(6327),c=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]])}return r},i=n.BH.ARTICLES,l=n.BH.CREATE,s=a.s.injectEndpoints({endpoints:function(e){return{fetchAllArticles:e.query({query:function(e){var t=e.limit,r=e.page,n=e.userLogin,a=e.userId,o=e.authUserId,c=e.textQuery,l=e.liked;return{url:"".concat(i,"/?sortByDate=true"),method:"POST",params:{limit:t,page:r,userLogin:n,search:c,liked:l||"",userId:a},body:{authUserId:o||""}}},transformResponse:function(e,t){var r,n,a=null===(n=null===(r=null==t?void 0:t.response)||void 0===r?void 0:r.headers)||void 0===n?void 0:n.get("X-Total-Count");return{data:e,totalCount:a?+a:1}},serializeQueryArgs:function(e){e.endpointName;var t=e.queryArgs;return t.page,c(t,["page"]),{queryArgs:t}},forceRefetch:function(e){var t=e.currentArg,r=e.previousArg;if(!t||!r)return!0;t.page;var n=c(t,["page"]),a=(r.page,c(r,["page"]));return(0,o.A)(n,a)}}),fetchArticleById:e.query({query:function(e){var t=e.id,r=e.userLogin,n=e.authUserId;return{url:"".concat(i,"/").concat(t),method:"POST",params:{userLogin:r},body:{authUserId:n||""}}}}),createArticle:e.mutation({query:function(e){return{url:"".concat(i).concat(l),method:"POST",body:e}}})}}}),u=s.useFetchAllArticlesQuery,f=s.useFetchArticleByIdQuery,p=s.useCreateArticleMutation;s.useLazyFetchAllArticlesQuery,s.useLazyFetchArticleByIdQuery},6327:(e,t,r)=>{function n(e,t){var r=Object.entries(e),n=Object.entries(t);if(r.length!==n.length)return!1;for(var a=0;a<r.length;++a)if(r[a][0]!==n[a][0]||r[a][1]!==n[a][1])return!1;return!0}r.d(t,{A:()=>n})}}]);